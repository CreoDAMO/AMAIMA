# ============================================================================
# AMAIMA Android — gradle.properties
# ============================================================================
# Gradle and Android build system configuration.
# Changes here apply to all modules in the project.
# ============================================================================

# ── JVM Arguments for Gradle Daemon ──────────────────────────────────────────
# Gradle 9.x daemon requires JDK 17+. These args assume JDK 17/21.
# -Xmx4g: 4GB heap — needed for Compose + Hilt KSP + ONNX native compilation
# -XX:+UseG1GC: G1 GC reduces pause times for large annotation processing runs
org.gradle.jvmargs=-Xmx4096m -XX:+UseG1GC -XX:MaxGCPauseMillis=100 -Dfile.encoding=UTF-8

# ── Gradle Parallel Builds ────────────────────────────────────────────────────
# Enable parallel project execution (safe for AMAIMA — single :app module)
org.gradle.parallel=true

# ── Gradle Build Cache ────────────────────────────────────────────────────────
# Reuse task outputs from previous builds (especially KSP generation tasks)
org.gradle.caching=true

# ── Gradle Configuration Cache ────────────────────────────────────────────────
# Gradle 9.x: configuration cache is stable. Caches the configuration phase
# result, skipping it entirely on subsequent builds with no config changes.
# NOTE: If plugins are incompatible with config cache, set to "warn" first.
org.gradle.configuration-cache=true
org.gradle.configuration-cache.problems=warn

# ── Android Build Options ─────────────────────────────────────────────────────
android.useAndroidX=true

# ── KSP Correctness ──────────────────────────────────────────────────────────
# KSP 1.0.31 (paired with KGP 2.3.10) incremental processing
ksp.incremental=true

# ── Kotlin / K2 Compiler ─────────────────────────────────────────────────────
# K2 compiler is default in KGP 2.0+. These settings control validation.
#
# kotlin.jvm.target.validation.mode:
#   "error"   — fail build if Kotlin JVM target mismatches Java target (default in AGP 8+)
#   "warning" — print warning but continue (use if you see target mismatch errors)
#   "ignore"  — skip check (not recommended)
kotlin.jvm.target.validation.mode=error

# ── AGP 9.x Feature Flags ────────────────────────────────────────────────────
# AGP 9.x built-in Kotlin is enabled by default. This means:
#   - AGP manages the Kotlin compilation directly
#   - You may remove `id("org.jetbrains.kotlin.android")` from app/build.gradle.kts
#     once you've verified this works (we keep it for now for explicit control)
#
# To opt out of built-in Kotlin (if you need explicit KGP control):
# android.builtInKotlin=false
#
# We leave this commented — built-in Kotlin ON by default in AGP 9.x.

# ── R8 / ProGuard ────────────────────────────────────────────────────────────
# AGP 9.x: R8 full mode is default in release builds.
# If your ONNX/TFLite proguard rules rely on keep rules in consumer files,
# verify they still work — global options in consumer rules are disallowed in R8 full mode.
android.enableR8.fullMode=true
